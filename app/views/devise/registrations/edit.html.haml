%h2 Edit #{resource_name.to_s.humanize}

= form_for resource, as: resource_name, url: registration_path(resource_name), html: { method: :put } do |f|

  = image_tag current_user.profile.avatar

  = f.fields_for :profile, resource.profile do |ff|
    = ff.file_field :avatar
    = ff.hidden_field :avatar_cache

    - if current_user.profile.avatar.url.present?
      = ff.label :remove_avatar
      = ff.check_box :remove_avatar

    = ff.label :username
    = ff.text_field :username, autofocus: true

    = ff.label :full_name
    = ff.text_field :full_name

    = ff.label :about_me
    = ff.text_area :about_me

  = f.label :email
  = f.email_field :email

  - if devise_mapping.confirmable? && resource.pending_reconfirmation?
    Currently waiting confirmation for: #{resource.unconfirmed_email}

  = f.label :password
  = f.password_field :password, autocomplete: "off"

  = f.label :password_confirmation
  = f.password_field :password_confirmation, autocomplete: "off"

  = f.password_field :current_password, autocomplete: "off", placeholder: 'Current password'

  = f.submit "Update"

%h3 Cancel my account

%p
  Unhappy?
  = button_to "Cancel my account", registration_path(resource_name), data: { confirm: "Are you sure?" }, method: :delete

= link_to "Back", :back
